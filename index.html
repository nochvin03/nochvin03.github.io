<!DOCTYPE html>
<html lang="ru">
   <head>
      <meta charset="UTF-8" />
      <meta http-equiv="X-UA-Compatible" content="IE=edge" />
      <meta name="viewport" content="width=device-width, initial-scale=1.0" />
      <title>Chat program</title>
      <link
         rel="stylesheet"
         href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.1/dist/css/bootstrap.min.css"
      />
      <style>
         body {
            background: #fcfcfc;
         }
      </style>
   </head>
   <body>
      <div
         class="d-flex flex-column flex-md-row align-items-center p-3 px-md-4 mb-3 bg-white border-bottom shadow-sm"
      >
         <h5 class="my-0 mr-md-auto">Dark chat</h5>
         <nav class="my-2 my-md-0 mr-md-3">
            <a href="#" class="p-2 text-dark">Головна</a>
            <a href="#" class="p-2 text-dark">Про нас</a>
            <a href="#" class="p-2 text-dark">Підтримка</a>
            <a href="#" class="p-2 text-dark">Ціни</a>
         </nav>
         <a href="#" class="btn btn-outline-primary">Регістрація</a>
      </div>
      <div class="container">
         <div class="py-5 text-center">
            <h2>Чат програма</h2>
            <p class="lead">Укажіть ваше ім'я та починайте листування</p>
         </div>
         <div class="row">
            <div class="col-6">
               <h3>Форма повідомлень</h3>
               <form id="messForm">
                  <label for="name">Ім'я</label>
                  <input
                     type="text"
                     name="name"
                     id="name"
                     placeholder="Введіть ім'я"
                     class="form-control"
                  />
                  <br />
                  <label for="message">Повідомлення</label>
                  <textarea
                     name="message"
                     id="message"
                     class="form-control"
                     placeholder="Введіть повідомлення"
                  ></textarea>
                  <br />
                  <input
                     type="submit"
                     value="Відправити"
                     class="btn btn-danger"
                  />
               </form>
            </div>
            <div class="col-6">
               <h3>Повідомлення</h3>
               <div id="all_mess"></div>
            </div>
         </div>
      </div>
      <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.1/jquery.min.js"></script>
      <script src="/socket.io/socket.io.js"></script>
      <script>
         let min = 1;
         let max = 6;
         let random = Math.floor(Math.random() * (max - min)) + min;

         let alertClass;
         switch (random) {
            case 1:
               alertClass = "secondary";
               break;
            case 2:
               alertClass = "danger";
               break;
            case 3:
               alertClass = "success";
               break;
            case 4:
               alertClass = "warning";
               break;
            case 5:
               alertClass = "info";
               break;
            case 6:
               alertClass = "light";
               break;
         }
         $(function () {
            let socket = io.connect();
            let $form = $("#messForm");
            let $name = $("#name");
            let $textarea = $("#message");
            let $all_messages = $("#all_mess");

            $form.submit(function (event) {
               event.preventDefault();
               socket.emit("send_mess", {
                  msg: $textarea.val(),
                  name: $name.val(),
                  className: alertClass,
               });
               $textarea.val("");
            });

            socket.on("add_mess", function (data) {
               $all_messages.append(
                  "<div class='alert alert-" +
                     data.className +
                     "'><b>" +
                     data.name +
                     ":</b> " +
                     data.msg +
                     "</div>"
               );
            });
         });
      </script>
   </body>
</html>
